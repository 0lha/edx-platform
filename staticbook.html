<%inherit file="main.html" />
<script>
var page=${ page };

$(document).ready(function(){
   $("#booknav").treeview({collapsed:true, unique:true/*, cookieId: "treeview-book-nav", persist: "cookie"*/});
});

function goto_page(n) {
  log_event("book", {"type":"gotopage","old":page,"new":n});
  page=n;
  var prefix = "";
  if(n<100) {
    prefix="0";
  }
  if(n<10) {
    prefix="00";
  }
  $("#bookpage").attr("src","/static/book/p"+prefix+n+".jpg");
};

function prev_page() {
  var newpage=page-1;
  if(newpage<1) newpage=1;
  goto_page(newpage);
  log_event("book", {"type":"prevpage","new":page});
}

function next_page() {
  var newpage=page+1;
  if(newpage>1764) newpage=1764;
  goto_page(newpage);
  log_event("book", {"type":"nextpage","new":page});
}
</script>

<%include file="navigation.html" />

<section class="book-container">
  <ul id="booknav" class="treeview-booknav">
    <%include file="book_toc.html" />
  </ul>

  <section class="book">
    <nav>
      <ol>
        <li>
          <a href="javascript:prev_page()">Last page</a>
        </li>
        <li>
          <a href="javascript:next_page()">Next page</a>
        </li>
      </ol>
    </nav>

    <section class="page">
      <img id="bookpage" src="/static/book/p${ "%03i"%(page) }.jpg">
    </section>
  </section>
</section>
